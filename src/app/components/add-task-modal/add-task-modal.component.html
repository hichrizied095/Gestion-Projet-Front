<div class="modal-header">
  <h5 class="modal-title">
    <i class="fas fa-plus-circle me-2"></i>Ajouter une tâche
  </h5>
  <button type="button" class="btn-close" aria-label="Close" (click)="cancel()"></button>
</div>

<div class="modal-body">
  <form (ngSubmit)="submit()" #taskForm="ngForm">
    
    <!-- Titre -->
    <div class="mb-3">
      <label for="title" class="form-label">
        <i class="fas fa-heading me-1"></i>Titre <span class="text-danger">*</span>
      </label>
      <input
        #titleInput
        id="title"
        class="form-control"
        [(ngModel)]="title"
        name="title"
        placeholder="Ex: Développer la fonctionnalité X"
        required
      />
    </div>

    <!-- Description (NOUVEAU) -->
    <div class="mb-3">
      <label for="description" class="form-label">
        <i class="fas fa-align-left me-1"></i>Description
      </label>
      <textarea
        id="description"
        class="form-control"
        [(ngModel)]="description"
        name="description"
        rows="4"
        placeholder="Décrivez la tâche en détail..."
      ></textarea>
      <small class="text-muted">Facultatif - Ajoutez des détails sur cette tâche</small>
    </div>

    <!-- Pourcentage de progression (NOUVEAU) -->
    <div class="mb-3">
      <label for="percentage">
  <i class="fas fa-weight-hanging me-1"></i>
  Poids de la tâche dans la colonne (%)
</label>
<small class="text-muted">
  Quelle part de cette colonne représente cette tâche ? 
  Exemple : 15% = cette tâche vaut 15% de la colonne totale
</small>
      <div class="input-group">
        <input
          id="percentage"
          class="form-control"
          type="number"
          [(ngModel)]="percentage"
          name="percentage"
          min="0"
          max="100"
          placeholder="0"
        />
        <span class="input-group-text">%</span>
      </div>
      <small class="text-muted">Optionnel - Entre 0 et 100%</small>
      
      <!-- Barre de progression visuelle -->
      <div class="progress mt-2" style="height: 25px;">
        <div 
          class="progress-bar"
          [class.bg-danger]="percentage < 30"
          [class.bg-warning]="percentage >= 30 && percentage < 70"
          [class.bg-success]="percentage >= 70"
          [style.width.%]="percentage || 0"
          role="progressbar"
          [attr.aria-valuenow]="percentage || 0"
          aria-valuemin="0"
          aria-valuemax="100">
          {{ percentage || 0 }}%
        </div>
      </div>
    </div>

    <!-- Assigner à -->
    <div class="mb-3">
      <label for="user" class="form-label">
        <i class="fas fa-user me-1"></i>Assigner à
      </label>
      <select [(ngModel)]="selectedUserId" name="user" class="form-select">
        <option [value]="null">-- Aucun utilisateur --</option>
        <option *ngFor="let user of users" [value]="user.id">
          {{ user.username }}
        </option>
      </select>
    </div>

    <!-- Date de début -->
    <div class="mb-3">
      <label for="startDate" class="form-label">
        <i class="fas fa-calendar-alt me-1"></i>Date de début <span class="text-danger">*</span>
      </label>
      <input
        id="startDate"
        class="form-control"
        type="date"
        [(ngModel)]="startDate"
        name="startDate"
        required
      />
    </div>

    <!-- Date limite -->
    <div class="mb-3">
      <label for="dueDate" class="form-label">
        <i class="fas fa-calendar-check me-1"></i>Date limite <span class="text-danger">*</span>
      </label>
      <input
        id="dueDate"
        class="form-control"
        type="date"
        [(ngModel)]="dueDate"
        name="dueDate"
        required
      />
    </div>

  </form>
</div>

<div class="modal-footer">
  <button class="btn btn-secondary" (click)="cancel()">
    <i class="fas fa-times me-1"></i>Annuler
  </button>
  <button 
    class="btn btn-primary" 
    (click)="submit()" 
    [disabled]="!title || !startDate || !dueDate">
    <i class="fas fa-check me-1"></i>Ajouter la tâche
  </button>
</div>